

(function(e){function f(t,n){if(a[t]===undefined){e.error("_GetSettingsParam: invalid settings type")}if(a[t][n]===undefined){e.error("_GetSettingsParam: invalid settings param name")}return a[t][n]}function l(t){var n=t.match(f("items","dateRegExpPattern"));if(!n||n.length<1){e.error("_GetDateFromCustomString: Cannot evaluate date from string '"+t+"'")}return new Date(n[1]||0,parseInt(n[2]||1,10)-1,n[3]||0,n[4]||0,n[5]||0,n[6]||0)}function c(e){if(!f("items","applySort")){return}var t=f("items","sortType")==="desc";e.sort(function(e,n){return t?n.date.getTime()-e.date.getTime():e.date.getTime()-n.date.getTime()})}function h(){t.css("position","relative");n.css("position","absolute");r.css("position","absolute")}function p(){n.css({left:t.outerWidth(true)/2-n.outerWidth()/2})}function d(){r.html("");var e=y(f("nav","lineClass"),r);o=(t.outerWidth(true)-r.outerWidth(true))/2;r.css({width:e.width(),left:o});e.css({position:"absolute",height:-parseInt(r.css("margin-top"),10)})}function v(){s=[];i=t.find("."+f("items","containerClass"));i.css("position","absolute");var n=f("items","dateAttributeName");i.each(function(){s.push({$el:e(this),date:l(e(this).data(n))})});c(s);i.css({width:t.width()/2-r.outerWidth(true)/2-parseInt(i.css("padding-left"),10)-parseInt(i.css("padding-right"),10)})}function m(e,t){var n=0;var r=f("separators","list");for(var i in r){switch(r[i].separateItemType){case"year":if(e.getYear()!==t.getYear()){n=n>r[i].gapSize?n:r[i].gapSize;continue}break;case"month":if(e.getMonth()!==t.getMonth()||e.getYear()!==t.getYear()){n=n>r[i].gapSize?n:r[i].gapSize;continue}break;case"day":if(e.getDate()!==t.getDate()||e.getMonth()!==t.getMonth()||e.getYear()!==t.getYear()){n=n>r[i].gapSize?n:r[i].gapSize;continue}break;case"hour":if(e.getHours()!==t.getHours()||e.getDate()!==t.getDate()||e.getMonth()!==t.getMonth()||e.getYear()!==t.getYear()){n=n>r[i].gapSize?n:r[i].gapSize;continue}break}}return n}function g(){if(!s.length){return}var n=parseInt(t.css("padding-top"),10);var o=n;var a=parseInt(i.css("margin-top"),10)+parseInt(i.css("margin-bottom"),10);var l=s[0].date;var c=0;var h=f("nav","lineClass");var p=e("."+h).width();var d=u;var v=f("nav","pointClass");var g=0;var b=f("items","arrowClass");var w=f("items","arrowClassLeft");var E=f("items","arrowClassRight");var S=n;for(var x in s){var T=s[x].$el;c=m(s[x].date,l);if(c){c=c>a?c:a;var N=n-o;if(N>=0){n+=c-a;o=n}else{o+=c-a;n=o}}var C=y(b,r);if(n<=o){T.css({left:parseInt(t.css("padding-left"),10),margin:0,top:n});g=n+(n>g-20?20:60);C.addClass(E);C.css({left:-parseInt(r.css("margin-left"),10)});n+=T.outerHeight(true)+a}else{T.css({left:r.position().left+r.outerWidth(true),margin:0,top:o});g=o+(o>g-20?20:60);C.addClass(w);C.css({right:-parseInt(r.css("margin-right"),10)});o+=T.outerHeight(true)+a}var k=y(v,r);k.css({top:g,left:-k.outerWidth(true)/2+p/2,position:"absolute"});var L=y(h,r);L.css({top:d,left:0,height:g-d,position:"absolute"});C.css({top:g-parseInt(k.css("margin-bottom"),10)/2,position:"absolute"});d=g+k.outerHeight(true);nNavH=T.outerHeight(true)+a;l=s[x].date}var A=(n>o?n:o)-a;A-=parseInt(t.css("padding-top"),10);t.css("height",A);r.css({height:d+k.outerHeight(true)})}function y(n,r){r=r||t;var i=e(document.createElement("div"));i.addClass(n);i.appendTo(r);return i}var t=null;var n=null;var r=null;var i=null;var s=[];var o=0;var u=0;var a={items:{containerClass:"timeline-item",arrowClass:"timeline-item-arrow",arrowClassRight:"right",arrowClassLeft:"left",sortType:"desc",applySort:true,dateAttributeName:"date",dateRegExpPattern:/(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/i},controls:{containerClass:"timeline-controls"},nav:{containerClass:"timeline-nav",lineClass:"timeline-nav-line",pointClass:"timeline-nav-point"},separators:{list:[]}};var b={init:function(e){for(var i in e){a[i]=a[i]||{};for(var s in e[i]){a[i][s]=e[i][s]}}t=this;n=t.find("."+f("controls","containerClass"));r=t.find("."+f("nav","containerClass"));h();d();p();v();g()},update:function(){d();v();g()}};e.fn.akqaTimelineV=function(t){if(b[t]){return b[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return b.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.akqaTimelineV")}}})(jQuery)